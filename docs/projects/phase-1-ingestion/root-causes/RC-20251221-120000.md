# RC-20251221-120000 - Batch ingest missing first-class batch→scope entrypoint

- **Title:** Batch ingest missing first-class batch→scope entrypoint
- **Date:** 2025-12-21
- **Owners:** Fred E
- **Linked invariant / plan section:** `docs/projects/phase-1-ingestion/ARTICLE6_INGEST_UPGRADE_PLAN.md`

## Summary
Batch artifacts existed, but ingest required a missing `ingest.<batch>.yml`, causing repeated stalls on “ingest file not found”.

## Root Cause
Workflows and scripts assumed a pre-existing ingest YAML and lacked a supported codes→ingest spec entrypoint, so “batch ingest” could not be executed from first principles.

## Fix
PR #312 merged:
- Added `npm run ingest:batch`.
- `discover-unfccc` emits deterministic ingest YAML from a codes file.
- Workflow accepts `codes_file` as an input for batch runs.
- Updated docs to reflect the supported entrypoint.

## Follow-up / Tests
- Primary workflow (batch → scoped ingest → validation):
  - `npm run ingest:batch -- --codes batches/<batch>.codes.txt --out ingest.<batch>.yml [--sector Agriculture|Forestry]`
- Scoped ingest idempotency gate:
  - `npm run ingest:scoped:idempotent -- ingest.<batch>.yml`
- Schema validation:
  - `npm run validate:rich`
  - `npm run validate:lean`
- Remaining gap:
  - Parity gates for `previous/` + `tools/` (fixtures ↔ filesystem ↔ `registry.json`) need to be enforced consistently across sectors.
