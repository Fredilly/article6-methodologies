name: validate
on: [push, pull_request]
jobs:
  ci:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: 20
      - run: npm ci || npm i
      - run: npm run validate
      - run: node tools/generate-report.mjs tests/fixtures/AR-AMS0007/sample_project_ok.geojson > out_ok.json
      - run: node tools/generate-report.mjs tests/fixtures/AR-AMS0007/sample_project_fail.geojson > out_fail.json
      - run: node tools/compute-hash.mjs out_ok.json && node tools/compute-hash.mjs out_fail.json
